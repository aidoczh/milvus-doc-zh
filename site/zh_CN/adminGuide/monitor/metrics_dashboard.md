---
id: metrics_dashboard.md
title: Milvus指标仪表盘
summary: 本主题介绍Milvus仪表盘中显示的监控指标。
---

# Milvus指标仪表盘

Milvus在运行时输出一系列详细的时间序列指标。您可以使用[Prometheus](https://prometheus.io/)和[Grafana](https://grafana.com/)来可视化这些指标。本主题介绍了Grafana Milvus仪表盘中显示的监控指标。


本主题中的时间单位为毫秒。本主题中的"99th percentile"指的是统计数据中有99%的时间控制在某个特定值内。

我们建议先阅读[Milvus监控框架概述](monitor_overview.md)以了解Prometheus指标。


<details><summary>代理</summary>

| 面板  | 面板描述  | PromQL（Prometheus查询语言）  | 使用的Milvus指标      | Milvus指标描述  |
|---|---|---|---|---|
| 检索向量计数速率  | 每个代理在过去两分钟内每秒查询的向量平均数量。  | ```  sum(increase(milvus_proxy_search_vectors_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (pod, node_id)  ```  | `milvus_proxy_search_vectors_count`  | 查询的向量累积数量。  |
| 插入向量计数速率  | 每个代理在过去两分钟内每秒插入的向量平均数量。  | ```  sum(increase(milvus_proxy_insert_vectors_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (pod, node_id)  ```  | `milvus_proxy_insert_vectors_count`  | 插入的向量累积数量。  |
| 检索延迟  | 每个代理在过去两分钟内接收检索和查询请求的平均延迟和第99百分位数延迟。  |  p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, query_type, pod, node_id) (rate(milvus_proxy_sq_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_proxy_sq_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, query_type) / sum(increase(milvus_proxy_sq_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, query_type)  ```  | `milvus_proxy_sq_latency`  | 检索和查询请求的延迟。  |
| 检索延迟 | 每个代理在过去两分钟内接收到针对特定集合的搜索和查询请求的平均延迟和延迟的第99百分位数。 | p99: <br/> ```histogram_quantile(0.99, sum by (le, query_type, pod, node_id) (rate(milvus_proxy_collection_sq_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace", collection_name=~"$collection"}[2m])))``` <br/> avg: <br/> ```sum(increase(milvus_proxy_collection_sq_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace", collection_name=~"$collection"}[2m])) by (pod, node_id, query_type) / sum(increase(milvus_proxy_collection_sq_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace", collection_name=~"$collection"}[2m])) by (pod, node_id, query_type)``` | `milvus_proxy_collection_sq_latency_sum` | 对特定集合的搜索和查询请求的延迟 |
| 变异延迟 | 每个代理在过去两分钟内接收到变异请求的平均延迟和延迟的第99百分位数。 | p99: <br/> ```histogram_quantile(0.99, sum by (le, msg_type, pod, node_id) (rate(milvus_proxy_mutation_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))``` <br/> avg: <br/> ```sum(increase(milvus_proxy_mutation_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, msg_type) / sum(increase(milvus_proxy_mutation_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, msg_type)``` | `milvus_proxy_mutation_latency_sum` | 变异请求的延迟。 |
| 集合变异延迟 | 每个代理在过去两分钟内接收到针对特定集合的变异请求的平均延迟和延迟的第99百分位数。 | p99: <br/> ```histogram_quantile(0.99, sum by (le, query_type, pod, node_id) (rate(milvus_proxy_collection_sq_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace", collection_name=~"$collection"}[2m])))``` <br/> avg: <br/> ```sum(increase(milvus_proxy_collection_sq_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace", collection_name=~"$collection"}[2m])) by (pod, node_id, query_type) / sum(increase(milvus_proxy_collection_sq_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace", collection_name=~"$collection"}[2m])) by (pod, node_id, query_type)``` | `milvus_proxy_collection_sq_latency_sum` | 对特定集合的变异请求的延迟 |
| 等待搜索结果延迟 | 在过去两分钟内，通过代理发送搜索和查询请求并接收结果之间的平均延迟和延迟的第99百分位数。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, query_type, pod, node_id) (rate(milvus_proxy_sq_wait_result_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>   平均值:  <br/>  ```  sum(increase(milvus_proxy_sq_wait_result_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, query_type) / sum(increase(milvus_proxy_sq_wait_result_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, query_type)  ```  | `milvus_proxy_sq_wait_result_latency`  | 发送搜索和查询请求并接收结果之间的延迟。  |
| 减少搜索结果延迟 | 在过去两分钟内，通过代理聚合搜索和查询结果的平均延迟和延迟的第99百分位数。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, query_type, pod, node_id) (rate(milvus_proxy_sq_reduce_result_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  平均值:  <br/>  ```  sum(increase(milvus_proxy_sq_reduce_result_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, query_type) / sum(increase(milvus_proxy_sq_reduce_result_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, query_type)  ```  | `milvus_proxy_sq_reduce_result_latency`  | 聚合每个查询节点返回的搜索和查询结果的延迟。  |
| 解码搜索结果延迟 | 在过去两分钟内，通过代理解码搜索和查询结果的平均延迟和延迟的第99百分位数。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, query_type, pod, node_id) (rate(milvus_proxy_sq_decode_result_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  平均值:  <br/>  ```  sum(increase(milvus_proxy_sq_decode_result_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, query_type) / sum(increase(milvus_proxy_sq_decode_resultlatency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, query_type)  ```  | `milvus_proxy_sq_decode_result_latency`  | 解码每个搜索和查询结果的延迟。  |
| 消息流对象数量 | 每个代理在过去两分钟内在相应物理主题上创建的消息流对象的平均值、最大值和最小值。 | ```  avg(milvus_proxy_msgstream_obj_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id)  max(milvus_proxy_msgstream_obj_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id)  min(milvus_proxy_msgstream_obj_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id)  ```  | `milvus_proxy_msgstream_obj_num`  | 每个物理主题上创建的消息流对象数量。  |
| 变异发送延迟 | 每个代理在过去两分钟内发送插入或删除请求的平均延迟和延迟的第99百分位数。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, msg_type, pod, node_id) (rate(milvus_proxy_mutation_send_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_proxy_mutation_send_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, msg_type) / sum(increase(milvus_proxy_mutation_send_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, msg_type)  ```  | `milvus_proxy_mutation_send_latency`  | 发送插入或删除请求的延迟。  |
| 缓存命中率 | 过去两分钟内每秒包括`GeCollectionID`、`GetCollectionInfo`和`GetCollectionSchema`等操作的平均缓存命中率。 | ```  sum(increase(milvus_proxy_cache_hit_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace", cache_state="hit"}[2m])/120) by(cache_name, pod, node_id) / sum(increase(milvus_proxy_cache_hit_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by(cache_name, pod, node_id)  ```  | `milvus_proxy_cache_hit_count`  | 每个缓存读取操作的命中率和失败率统计。  |
| 缓存更新延迟 | 过去两分钟内每个代理的缓存更新延迟的平均延迟和第99百分位数。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_proxy_cache_update_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_proxy_cache_update_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id) / sum(increase(milvus_proxy_cache_update_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id)  ```  | `milvus_proxy_cache_update_latency`  | 每次更新缓存的延迟。  |
| 同步时间 | 每个代理在其对应的物理通道中同步的时代时间的平均值、最大值和最小值。 | ```  avg(milvus_proxy_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id)  max(milvus_proxy_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id)  min(milvus_proxy_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id)  ```  | `milvus_proxy_sync_epoch_time `  | 每个物理通道的时代时间（Unix时间，自1970年1月1日以来经过的毫秒数）。<br/>除了物理通道外，还有一个默认的`ChannelName`。  |
| 应用主键延迟 | 过去两分钟内每个代理应用主键的主键应用延迟的平均延迟和第99百分位数。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_proxy_apply_pk_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_proxy_apply_pk_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id) / sum(increase(milvus_proxy_apply_pk_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id)  ```  | `milvus_proxy_apply_pk_latency`  | 应用主键的延迟。 |
| 应用时间戳延迟 | 过去两分钟内每个代理应用时间戳的平均延迟和第99百分位数延迟。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_proxy_apply_timestamp_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  平均值:  <br/>  ```  sum(increase(milvus_proxy_apply_timestamp_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id) / sum(increase(milvus_proxy_apply_timestamp_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id)  ```  | `milvus_proxy_apply_timestamp_latency`  | 应用时间戳的延迟。  |
| 请求成功率 | 每个代理每秒收到的成功请求数量，详细列出每种请求类型。可能的请求类型包括DescribeCollection、DescribeIndex、GetCollectionStatistics、HasCollection、Search、Query、ShowPartitions、Insert等。 | ```sum(increase(milvus_proxy_req_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace", status="success"}[2m])/120) by(function_name, pod, node_id)``` | `milvus_proxy_req_count` | 所有类型接收请求的数量 |
| 请求失败率 | 每个代理每秒收到的失败请求数量，详细列出每种请求类型。可能的请求类型包括DescribeCollection、DescribeIndex、GetCollectionStatistics、HasCollection、Search、Query、ShowPartitions、Insert等。 | ```sum(increase(milvus_proxy_req_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace", status="fail"}[2m])/120) by(function_name, pod, node_id)``` | `milvus_proxy_req_count` | 所有类型接收请求的数量 |
| 请求延迟 | 每个代理接收的所有类型请求的平均延迟和第99百分位数延迟 | p99: <br/> ```histogram_quantile(0.99, sum by (le, pod, node_id, function_name) (rate(milvus_proxy_req_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))``` <br/> 平均值: <br/> ```sum(increase(milvus_proxy_req_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, function_name) / sum(increase(milvus_proxy_req_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (pod, node_id, function_name)``` | `milvus_proxy_req_latency` | 所有类型接收请求的延迟 | 
| 插入/删除请求字节速率 | 代理在过去两分钟内每秒接收的插入和删除请求字节数。 | ``` sum(increase(milvus_proxy_receive_bytes_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by(pod, node_id) ``` | `milvus_proxy_receive_bytes_count` | 插入和删除请求的计数。 |
| 发送字节速率 | 每个代理在过去两分钟内响应搜索和查询请求时每秒发送回客户端的字节数。 | ``` sum(increase(milvus_proxy_send_bytes_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by(pod, node_id) ``` | `milvus_proxy_send_bytes_count` | 每个代理在响应搜索和查询请求时发送回客户端的字节数。 |

</details>


<details><summary>根协调器</summary>
  
  
| 面板 | 面板描述 | PromQL（Prometheus查询语言） | 使用的 Milvus 指标 | Milvus 指标描述 |
|---|---|---|---|---|
| 代理节点数 | 创建的代理数量。 | ``` sum(milvus_rootcoord_proxy_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) ``` | `milvus_rootcoord_proxy_num` | 代理的数量。 |
| 同步时间 | 每个根协调器在每个物理通道（PChannel）中同步的平均、最大和最小时代时间数。 | ``` avg(milvus_rootcoord_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) max(milvus_rootcoord_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) min(milvus_rootcoord_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) ``` | `milvus_rootcoord_sync_epoch_time` | 每个物理通道的时代时间（Unix 时间，自1970年1月1日以来经过的毫秒数）。 |
| DDL 请求速率 | 过去两分钟内每秒的DDL请求状态和数量。 | ``` sum(increase(milvus_rootcoord_ddl_req_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (status, function_name) ``` | `milvus_rootcoord_ddl_req_count` | DDL 请求的总数，包括 `CreateCollection`、`DescribeCollection`、`DescribeSegments`、`HasCollection`、`ShowCollections`、`ShowPartitions` 和 `ShowSegments`。 |
| DDL 请求延迟 | 过去两分钟内DDL请求的平均延迟和第99百分位延迟。 | p99: <br/> ```histogram_quantile(0.99, sum by (le, function_name) (rate(milvus_rootcoord_ddl_req_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))``` <br/> avg: <br/> ```sum(increase(milvus_rootcoord_ddl_req_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (function_name) / sum(increase(milvus_rootcoord_ddl_req_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by (function_name)``` | `milvus_rootcoord_ddl_req_latency` | 所有类型DDL请求的延迟。 |
| 同步Timetick延迟 | 过去两分钟内根协调器用于将所有时间戳同步到P通道的平均延迟和第99百分位。 | p99: <br/> ```histogram_quantile(0.99, sum by (le) (rate(milvus_rootcoord_sync_timetick_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))``` <br/> avg: <br/> ```sum(increase(milvus_rootcoord_sync_timetick_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) / sum(increase(milvus_rootcoord_sync_timetick_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m]))``` | `milvus_rootcoord_sync_timetick_latency` | 根协调器用于将所有时间戳同步到P通道的时间。 |
| ID分配速率 | 过去两分钟内根协调器每秒分配的ID数量。 | ```sum(increase(milvus_rootcoord_id_alloc_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120)``` | `milvus_rootcoord_id_alloc_count` | 根协调器分配的ID累积数量。 |
| 时间戳 | 根协调器的最新时间戳。 | ```milvus_rootcoord_timestamp{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}``` | `milvus_rootcoord_timestamp` | 根协调器的最新时间戳。 |
| 已保存时间戳 | 根协调器保存在元数据存储中的预分配时间戳。 | ```milvus_rootcoord_timestamp_saved{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}``` | `milvus_rootcoord_timestamp_saved` | 根协调器保存在元数据存储中的预分配时间戳。 <br/> 这些时间戳提前3秒分配。时间戳每50毫秒更新并保存在元数据存储中。 |
<details><summary>数据协调器</summary>

| 集合数量 | 所有集合的总数。 | ``` sum(milvus_rootcoord_collection_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) ``` | `milvus_rootcoord_collection_num` | Milvus当前存在的集合总数。 |
| 分区数量 | 所有分区的总数。 | ``` sum(milvus_rootcoord_partition_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) ``` | `milvus_rootcoord_partition_num` | Milvus当前存在的分区总数。 |
| DML通道数量 | 所有DML通道的总数。 | ``` sum(milvus_rootcoord_dml_channel_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) ``` | `milvus_rootcoord_dml_channel_num` | Milvus当前存在的DML通道总数。 |
| Msgstream数量 | 所有消息流的总数。 | ``` sum(milvus_rootcoord_msgstream_obj_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) ``` | `milvus_rootcoord_msgstream_obj_num` | Milvus当前存在的消息流总数。 |
| 凭证数量 | 所有凭证的总数。 | ``` sum(milvus_rootcoord_credential_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) ``` | `milvus_rootcoord_credential_num` | Milvus当前存在的凭证总数。 |
| 时间滴答延迟 | 所有DataNode和QueryNode上流图的最大时间滴答延迟之和。 | ```sum(milvus_rootcoord_time_tick_delay{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)``` | `milvus_rootcoord_time_tick_delay` | 每个DataNode和QueryNode上流图的最大时间滴答延迟。 |

</details>

<details><summary>查询协调器</summary>

| 面板 | 面板描述 | PromQL（Prometheus查询语言） | 使用的Milvus指标 | Milvus指标描述 |
|---|---|---|---|---|
| 已加载集合数量 | 当前加载到内存中的集合数量。 | ``` sum(milvus_querycoord_collection_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) ``` | `milvus_querycoord_collection_num` | Milvus当前加载的集合数量。 |
| 实体加载数量 | 当前加载到内存中的实体数量。 | ``` sum(milvus_querycoord_entity_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance) ``` | `milvus_querycoord_entitiy_num` | Milvus 当前加载的实体数量。 |
| 加载请求速率 | 过去两分钟内每秒的加载请求次数。 | ``` sum(increase(milvus_querycoord_load_req_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])120) by (status) ``` | `milvus_querycoord_load_req_count` | 累积的加载请求次数。 |
| 释放请求速率 | 过去两分钟内每秒的释放请求次数。 | ``` sum(increase(milvus_querycoord_release_req_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (status) ``` | `milvus_querycoord_release_req_count` | 累积的释放请求次数。 |
| 加载请求延迟 | 过去两分钟内加载请求的平均延迟和第99百分位延迟。 | p99: <br/> ``` histogram_quantile(0.99, sum by (le) (rate(milvus_querycoord_load_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m]))) ``` <br/> avg: <br/> ``` sum(increase(milvus_querycoord_load_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) / sum(increase(milvus_querycoord_load_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) ``` | `milvus_querycoord_load_latency` | 完成加载请求所用的时间。 |
| 释放请求延迟 | 过去两分钟内释放请求的平均延迟和第99百分位延迟。 | p99: <br/> ``` histogram_quantile(0.99, sum by (le) (rate(milvus_querycoord_release_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m]))) ``` <br/> avg: <br/> ``` sum(increase(milvus_querycoord_release_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) / sum(increase(milvus_querycoord_release_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) ``` | `milvus_querycoord_release_latency` | 完成释放请求所用的时间。 |
| 子加载任务  | 子加载任务的数量。    | ```  sum(milvus_querycoord_child_task_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)  ```  | `milvus_querycoord_child_task_num`  | 子加载任务的数量。    <br/>    查询协调器将加载请求拆分为多个子加载任务。   |
| 父加载任务  | 父加载任务的数量。    | ```  sum(milvus_querycoord_parent_task_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)  ```  | `milvus_querycoord_parent_task_num`  | 父加载任务的数量。    <br/>    每个加载请求对应任务队列中的一个父任务。  |
| 子加载任务延迟  | 过去两分钟内子加载任务的平均延迟和延迟的第99百分位数。  | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le) (rate(milvus_querycoord_child_task_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_querycoord_child_task_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) / sum(increase(milvus_querycoord_child_task_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m]))   namespace"}[2m])))  ```  | `milvus_querycoord_child_task_latency`  | 完成子加载任务的延迟。  |
| 查询节点数量  | 查询协调器管理的查询节点数量。  | ```  sum(milvus_querycoord_querynode_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)  ```  | `milvus_querycoord_querynode_num`  | 查询协调器管理的查询节点数量。  |
  
</details>


<details><summary>查询节点</summary>
  
| 面板  | 面板描述  | PromQL（Prometheus查询语言）  | 使用的 Milvus 指标  | Milvus 指标描述  |
|---|---|---|---|---|
| 加载的集合数量  | 每个查询节点加载到内存中的集合数量。    | ```  sum(milvus_querynode_collection_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id)  ```  | `milvus_querynode_collection_num`    | 每个查询节点加载的集合数量。    |
| 加载的分区数量  | 每个查询节点加载到内存中的分区数量。    | ```  sum(milvus_querynode_partition_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id)  ```  | `milvus_querynode_partition_num`  | 每个查询节点加载的分区数量。    |
| 段加载数量 | 每个查询节点加载到内存中的段的数量。 | ``` sum(milvus_querynode_segment_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_querynode_segment_num` | 每个查询节点加载的段的数量。 |
| 可查询实体数量 | 每个查询节点上可查询和可搜索实体的数量。 | ``` sum(milvus_querynode_entity_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_querynode_entity_num` | 每个查询节点上可查询和可搜索实体的数量。 |
| DML虚拟通道 | 每个查询节点监视的DML虚拟通道数量。 | ``` sum(milvus_querynode_dml_vchannel_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_querynode_dml_vchannel_num` | 每个查询节点监视的DML虚拟通道数量。 |
| Delta虚拟通道 | 每个查询节点监视的增量通道数量。 | ``` sum(milvus_querynode_delta_vchannel_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_querynode_delta_vchannel_num` | 每个查询节点监视的增量通道数量。 |
| 消费者数量 | 每个查询节点中的消费者数量。 | ``` sum(milvus_querynode_consumer_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_querynode_consumer_num` | 每个查询节点中的消费者数量。 |
| 搜索请求速率 | 每个查询节点每秒接收的搜索和查询请求总数，以及过去两分钟内成功的搜索和查询请求的数量。 | ``` sum(increase(milvus_querynode_sq_req_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (query_type, status, pod, node_id) ``` | `milvus_querynode_sq_req_count` | 搜索和查询请求的累积数量。 |
| 搜索请求延迟 | 过去两分钟内每个查询节点在搜索和查询请求中使用的平均延迟和第99百分位时间。 <br/>此面板显示状态为“success”或“total”的搜索和查询请求的延迟。 | p99: <br/> ``` histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_querynode_sq_req_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m]))) ``` <br/> avg: <br/> ``` sum(increase(milvus_querynode_sq_req_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id, query_type) / sum(increase(milvus_querynode_sq_req_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id, query_type) ``` | `milvus_querynode_sq_req_latency` | 查询节点的搜索请求延迟。 |
| 队列中的搜索延迟 | 过去两分钟内队列中搜索和查询请求的平均延迟和第99百分位延迟。 | p99: <br/> ``` histogram_quantile(0.99, sum by (le, pod, node_id, query_type) (rate(milvus_querynode_sq_queue_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m]))) ``` <br/> avg: <br/> ``` sum(increase(milvus_querynode_sq_queue_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id, query_type) / sum(increase(milvus_querynode_sq_queue_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id, query_type) ``` | `milvus_querynode_sq_queue_latency` | 查询节点接收的搜索和查询请求的延迟。 |
| 搜索段延迟 | 过去两分钟内每个查询节点搜索和查询段所需的平均延迟和第99百分位时间。 <br/>段的状态可以是sealed或growing。 | p99: <br/> ``` histogram_quantile(0.99, sum by (le, query_type, segment_state, pod, node_id) (rate(milvus_querynode_sq_segment_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m]))) ``` <br/> avg: <br/> ``` sum(increase(milvus_querynode_sq_segment_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id, query_type, segment_state) / sum(increase(milvus_querynode_sq_segment_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id, query_type, segment_state) ``` | `milvus_querynode_sq_segment_latency` | 每个查询节点搜索和查询每个段所需的时间。 |
| Segcore 请求延迟 | 过去两分钟内每个查询节点在 segcore 中搜索和查询所花费的平均延迟和第 99 百分位的时间。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, query_type, pod, node_id) (rate(milvus_querynode_sq_core_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_querynode_sq_core_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id, query_type) / sum(increase(milvus_querynode_sq_core_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id, query_type)  ```  | `milvus_querynode_sq_core_latency` | 每个查询节点在 segcore 中搜索和查询所花费的时间。 |
| 搜索减少延迟 | 过去两分钟内每个查询节点在搜索或查询的减少阶段中所用的平均延迟和第 99 百分位的时间。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id, query_type) (rate(milvus_querynode_sq_reduce_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_querynode_sq_reduce_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id, query_type) / sum(increase(milvus_querynode_sq_reduce_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id, query_type)  ```  | `milvus_querynode_sq_reduce_latency` | 每个查询在减少阶段花费的时间。 |
| 加载段延迟 | 过去两分钟内每个查询节点加载段所花费的平均延迟和第 99 百分位的时间。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_querynode_load_segment_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_querynode_load_segment_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_querynode_load_segment_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_querynode_load_segment_latency_bucket` | 每个查询节点加载段所花费的时间。 |
| 流程图数量 | 每个查询节点中流程图的数量。 | ``` sum(milvus_querynode_flowgraph_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_querynode_flowgraph_num` | 每个查询节点中流程图的数量。 |
| 未解决的读取任务长度 | 每个查询节点中未解决读取请求队列的长度。 | ``` sum(milvus_querynode_read_task_unsolved_len{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_querynode_read_task_unsolved_len` | 未解决读取请求队列的长度。 |
| 就绪的读取任务长度 | 每个查询节点中待执行读取请求队列的长度。 | ``` sum(milvus_querynode_read_task_ready_len{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_querynode_read_task_ready_len` | 待执行读取请求队列的长度。 |
| 并行读取任务数量 | 每个查询节点中当前正在执行的并发读取请求数量。 | ``` sum(milvus_querynode_read_task_concurrency{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_querynode_read_task_concurrency` | 当前正在执行的并发读取请求数量。 |
| 估计 CPU 使用率 | 调度程序估计的每个查询节点的 CPU 使用率。 | ``` sum(milvus_querynode_estimate_cpu_usage{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_querynode_estimate_cpu_usage` | 调度程序估计的每个查询节点的 CPU 使用率。 <br/> 当数值为100时，表示使用了一个完整的虚拟 CPU（vCPU）。 |
| 搜索组大小 | 过去两分钟内每个查询节点执行的组合搜索请求中搜索组大小（即每个查询节点执行的组合搜索请求中原始搜索请求的总数）的平均值和第99百分位数。 | p99: <br/> ``` histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_querynode_search_group_size_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m]))) ``` <br/> avg: <br/> ``` sum(increase(milvus_querynode_search_group_size_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_querynode_search_group_size_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) ``` | `milvus_querynode_load_segment_latency_bucket` | 不同桶中组合搜索任务中的原始搜索任务数量（即搜索组大小）。 |
| 搜索查询次数（NQ） | 每个查询节点在过去两分钟内执行搜索请求时的平均查询次数和第99百分位数。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_querynode_search_group_size_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_querynode_search_group_size_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_querynode_search_group_size_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | milvus_querynode_load_segment_latency_bucket  | 搜索请求的查询次数（NQ）。   |
| 搜索组查询次数（Search Group NQ） | 每个查询节点在过去两分钟内组合执行的搜索请求的平均查询次数和第99百分位数。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_querynode_search_group_nq_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_querynode_search_group_nq_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_querynode_search_group_nq_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_querynode_load_segment_latency_bucket`  | 不同桶中组合的搜索请求的查询次数（NQ）。  |
| 搜索Top_K次数 | 每个查询节点在过去两分钟内执行的搜索请求的平均Top_K次数和第99百分位数。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_querynode_search_topk_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_querynode_search_topk_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_querynode_search_topk_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_querynode_load_segment_latency_bucket`  | 搜索请求的Top_K次数。  |
<details><summary>搜索组 Top_K</summary>
  
| 指标  | 描述  | PromQL (Prometheus 查询语言)  | 使用的 Milvus 指标  | Milvus 指标描述  |
|---|---|---|---|---|
| 搜索请求 Top_K 平均值和第99百分位数  | 过去两分钟内每个查询节点组合和执行的搜索请求的 `Top_K` 的平均数和第99百分位数。  | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_querynode_search_group_topk_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_querynode_search_group_topk_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_querynode_search_group_topk_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_querynode_load_segment_latency_bucket`  | 不同桶中组合的搜索请求的 `Top_K`。  |
| 被驱逐的读请求速率  | 过去两分钟内每个查询节点每秒被驱逐的读请求数量。  | ```  sum(increase(milvus_querynode_read_evicted_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (pod, node_id)  ```  | `milvus_querynode_sq_req_count`  | 由于流量限制而被查询节点驱逐的读请求累积数量。  |
  
</details>


<details><summary>数据协调器</summary>
  
| 指标  | 描述  | PromQL (Prometheus 查询语言)  | 使用的 Milvus 指标  | Milvus 指标描述  |
|---|---|---|---|---|
| 数据节点数量  | 数据协调器管理的数据节点数量。  | ```  sum(milvus_datacoord_datanode_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)  ```  | `milvus_datacoord_datanode_num`  | 数据协调器管理的数据节点数量。  |
| 分段数量  | 数据协调器在元数据中记录的所有类型分段的数量。    | ```  sum(milvus_datacoord_segment_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (segment_state)  ```  | `milvus_datacoord_segment_num`  | 数据协调器在元数据中记录的所有类型分段的数量。    <br/>    分段类型包括：已删除、已刷新、正在刷新、增长中和已封存。    |
| 集合数量  | 数据协调器在元数据中记录的集合数量。    | ```  sum(milvus_datacoord_collection_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)  ```  | `milvus_datacoord_collection_num`  | 数据协调器在元数据中记录的集合数量。    |
| 存储行数 | 数据协调器中有效且已刷新数据行数的累积数量。 | ```  sum(milvus_datacoord_stored_rows_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)  ``` | `milvus_datacoord_stored_rows_num` | 数据协调器中有效且已刷新数据行数的累积数量。 |
| 存储行数速率 | 过去两分钟内每秒刷新的平均行数。 | ```  sum(increase(milvus_datacoord_stored_rows_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (pod, node_id)  ``` | `milvus_datacoord_stored_rows_count` | 数据协调器刷新的行数累积数量。 |
| 同步时间 | 数据协调器在每个物理通道中同步的平均、最大和最小时代时间数量。 | ```  avg(milvus_datacoord_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)  max(milvus_datacoord_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)  min(milvus_datacoord_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)  ``` | `milvus_datacoord_sync_epoch_time` | 每个物理通道的时代时间（Unix时间，自1970年1月1日以来经过的毫秒数）。 |
| 存储Binlog大小 | 存储的Binlog总大小。 | ```sum(milvus_datacoord_stored_binlog_size{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)``` | `milvus_datacoord_stored_binlog_size` | 存储在Milvus中的Binlog总大小。 |

</details>

<details><summary>数据节点</summary>

| 面板 | 面板描述 | PromQL（Prometheus查询语言） | 使用的Milvus指标 | Milvus指标描述 |
|---|---|---|---|---|
| 流图数量 | 与每个数据节点对应的流图对象数量。 | ```  sum(milvus_datanode_flowgraph_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id)  ``` | `milvus_datanode_flowgraph_num` | 流图对象的数量。 <br/> 每个集合中的分片对应一个流图对象。 |
| 消息行消耗速率 | 每个数据节点在过去两分钟内每秒消耗的流式消息行数。 | ``` sum(increase(milvus_datanode_msg_rows_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (msg_type, pod, node_id) ``` | `milvus_datanode_msg_rows_count` | 流式消息的行数。 <br/> 目前，数据节点统计的流式消息仅包括插入和删除消息。 |
| 刷新数据大小速率 | 每个数据节点在过去两分钟内记录的每个刷新消息的大小。 | ``` sum(increase(milvus_datanode_flushed_data_size{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (msg_type, pod, node_id) ``` | `milvus_datanode_flushed_data_size` | 每个刷新消息的大小。 <br/> 目前，数据节点统计的流式消息仅包括插入和删除消息。 |
| 消费者数量 | 每个数据节点上创建的消费者数量。 | ``` sum(milvus_datanode_consumer_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_datanode_consumer_num` | 每个数据节点上创建的消费者数量。 <br/> 每个流图对应一个消费者。 |
| 生产者数量 | 每个数据节点上创建的生产者数量。 | ``` sum(milvus_datanode_producer_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_datanode_producer_num` | 每个数据节点上创建的消费者数量。 <br/> 集合中的每个分片对应一个增量通道生产者和一个时间标记通道生产者。 |
| 同步时间 | 每个数据节点在所有物理主题中同步的平均、最大和最小时代时间数。 | ``` avg(milvus_datanode_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) max(milvus_datanode_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) min(milvus_datanode_sync_epoch_time{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id) ``` | `milvus_datanode_sync_epoch_time` | 每个数据节点上每个物理主题的时代时间（Unix时间，自1970年1月1日以来经过的毫秒数）。 |
| 未刷新的段数  | 每个数据节点上创建的未刷新段的数量。  | ```  sum(milvus_datanode_unflushed_segment_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (pod, node_id)  ```  | `milvus_datanode_unflushed_segment_num`  | 每个数据节点上创建的未刷新段的数量。  |
| 编码缓冲延迟  | 过去两分钟内每个数据节点用于编码缓冲区的平均延迟和第99百分位时间。  | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_datanode_encode_buffer_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_datanode_encode_buffer_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_datanode_encode_buffer_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_datanode_encode_buffer_latency`  | 每个数据节点用于编码缓冲区的时间。    |
| 保存数据延迟  | 过去两分钟内每个数据节点将缓冲区写入存储层所用的平均延迟和第99百分位时间。  | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_datanode_save_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_datanode_save_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_datanode_save_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_datanode_save_latency`  | 每个数据节点将缓冲区写入存储层所用的时间。    |
| 刷新操作速率  | 过去两分钟内每个数据节点每秒刷新缓冲区的次数。  | ```  sum(increase(milvus_datanode_flush_buffer_op_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (status, pod, node_id)  ```  | `milvus_datanode_flush_buffer_op_count`  | 数据节点刷新缓冲区的累积次数。  |
| 自动刷新操作速率 | 过去两分钟内每个数据节点自动刷新缓冲区的次数。 | ``` sum(increase(milvus_datanode_autoflush_buffer_op_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (status, pod, node_id) ``` | `milvus_datanode_autoflush_buffer_op_count` | 数据节点自动刷新缓冲区的累积次数。 |
| 刷新请求速率 | 过去两分钟内每个数据节点接收缓冲区刷新请求的次数。 | ``` sum(increase(milvus_datanode_flush_req_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (status, pod, node_id) ``` | `milvus_datanode_flush_req_count` | 数据节点接收来自数据协调器的刷新请求的累积次数。 |
| 压缩延迟 | 每个数据节点执行压缩任务所需的平均延迟和99百分位数。 | p99: <br/> ``` histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_datanode_compaction_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m]))) ``` <br/> avg: <br/> ``` sum(increase(milvus_datanode_compaction_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_datanode_compaction_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) ``` | `milvus_datanode_compaction_latency` | 每个数据节点执行压缩任务所需的时间。 |

<details><summary>索引协调器</summary>

| 面板 | 面板描述 | PromQL（Prometheus查询语言） | 使用的 Milvus 指标 | Milvus 指标描述 |
|---|---|---|---|---|
| 索引请求速率 | 过去两分钟内平均收到的索引构建请求次数。 | ``` sum(increase(milvus_indexcoord_indexreq_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (status) ``` | `milvus_indexcoord_indexreq_count` | 收到的索引构建请求次数。 |
| 索引任务计数 | 记录在索引元数据中的所有索引任务计数。 | ``` sum(milvus_indexcoord_indextask_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (index_task_status) ``` | `milvus_indexcoord_indextask_count` | 记录在索引元数据中的所有索引任务计数。 |
| 索引节点数  | 管理的索引节点数量。    | ```  sum(milvus_indexcoord_indexnode_num{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}) by (app_kubernetes_io_instance)  ```  | `milvus_indexcoord_indexnode_num`  | 管理的索引节点数量。    |
  
</details>

<details><summary>索引节点</summary>
  
| 面板  | 面板描述  | PromQL（Prometheus 查询语言）  | 使用的 Milvus 指标  | Milvus 指标描述  |
|---|---|---|---|---|
| 索引任务速率  | 每个索引节点在过去两分钟内平均接收到的构建索引任务数量。  | ```  sum(increase(milvus_indexnode_index_task_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])/120) by (status, pod, node_id)  ```  | `milvus_indexnode_index_task_count`  | 接收到的构建索引任务数量。  |
| 加载字段延迟  | 每个索引节点在过去两分钟内每次加载段字段数据所用的平均延迟和第99百分位数的时间。  | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_indexnode_load_field_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_indexnode_load_field_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_indexnode_load_field_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_indexnode_load_field_latency`  | 加载段字段数据所用的时间。   |
| 解码字段延迟  | 每个索引节点在过去两分钟内每次解码字段数据所用的平均延迟和第99百分位数的时间。    | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_indexnode_decode_field_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_indexnode_decode_field_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_indexnode_decode_field_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_indexnode_decode_field_latency`  | 解码字段数据所用的时间。  |
| 构建索引延迟 | 每个索引节点在过去两分钟内构建索引所用的平均延迟和第99百分位数的时间。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_indexnode_build_index_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_indexnode_build_index_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_indexnode_build_index_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_indexnode_build_index_latency` | 用于构建索引的时间。 |
| 编码索引延迟 | 每个索引节点在过去两分钟内编码索引文件所用的平均延迟和第99百分位数的时间。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_indexnode_encode_index_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_indexnode_encode_index_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_indexnode_encode_index_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_indexnode_encode_index_latency` | 用于编码索引文件的时间。 |
| 保存索引延迟 | 每个索引节点在过去两分钟内保存索引文件所用的平均延迟和第99百分位数的时间。 | p99:  <br/>  ```  histogram_quantile(0.99, sum by (le, pod, node_id) (rate(milvus_indexnode_save_index_latency_bucket{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])))  ```  <br/>  avg:  <br/>  ```  sum(increase(milvus_indexnode_save_index_latency_sum{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id) / sum(increase(milvus_indexnode_save_index_latency_count{app_kubernetes_io_instance=~"$instance", app_kubernetes_io_name="$app_name", namespace="$namespace"}[2m])) by(pod, node_id)  ```  | `milvus_indexnode_save_index_latency` | 用于保存索引文件的时间。 |